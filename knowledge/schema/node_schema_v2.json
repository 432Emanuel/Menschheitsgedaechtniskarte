{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Node Schema v2",
  "description": "Schema für Knoten in der Menschheitsgedächtniskarte",
  "type": "object",
  "properties": {
    "node_id": {
      "type": "string",
      "description": "Eindeutige Kennung des Knotens"
    },
    "title": {
      "type": "string",
      "description": "Titel des Knotens"
    },
    "node_type": {
      "type": "string",
      "enum": ["place", "feature", "artifact", "narrative", "concept"],
      "description": "Art des Knotens"
    },
    "epistemic_layer_id": {
      "type": "string",
      "enum": ["L1", "L2", "L3", "L4"],
      "description": "Epistemischer Layer (L1=Gesicherte Daten, L2=Überlieferte Erinnerung, L3=Brüche & Lücken, L4=Spiegelräume)"
    },
    "time_window": {
      "type": "object",
      "properties": {
        "start_year": {
          "type": ["integer", "null"],
          "description": "Startjahr (negativ für BCE, positiv für CE)"
        },
        "end_year": {
          "type": ["integer", "null"],
          "description": "Endjahr"
        },
        "era": {
          "type": ["string", "null"],
          "enum": ["BCE", "CE", "BP", "unknown"],
          "description": "Zeitrechnungssystem"
        }
      }
    },
    "geo": {
      "type": "object",
      "properties": {
        "region": {
          "type": ["string", "null"],
          "description": "Region oder Beschreibung des Ortes"
        },
        "lat": {
          "type": ["number", "null"],
          "description": "Breitengrad"
        },
        "lon": {
          "type": ["number", "null"],
          "description": "Längengrad"
        }
      }
    },
    "claims": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "statement": {
            "type": "string",
            "description": "Die Aussage"
          },
          "claim_type": {
            "type": "string",
            "enum": ["data", "tradition", "hypothesis", "symbol"],
            "description": "Art der Aussage"
          },
          "confidence": {
            "type": ["number", "null"],
            "minimum": 0,
            "maximum": 1,
            "description": "Konfidenzwert (0-1)"
          },
          "tags": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        },
        "required": ["statement", "claim_type"]
      }
    },
    "resonance": {
      "type": "object",
      "properties": {
        "layer_notes": {
          "type": "object",
          "properties": {
            "R0": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Primärwahrnehmung"
            },
            "R1": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Strukturlogik"
            },
            "R2": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Funktion vor Symbol"
            },
            "R3": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Projektions-Check"
            },
            "R4": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Missverständnisarchäologie"
            },
            "R5": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Selbsterkenntnis / Individuation"
            }
          }
        }
      }
    },
    "sources": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "enum": ["paper", "book", "artifact", "dataset", "oral", "map", "experiment", "media", "other"],
            "description": "Art der Quelle"
          },
          "citation": {
            "type": "string",
            "description": "Zitierangabe"
          },
          "url": {
            "type": ["string", "null"],
            "description": "URL (optional)"
          },
          "notes": {
            "type": ["string", "null"],
            "description": "Zusätzliche Anmerkungen"
          }
        },
        "required": ["type", "citation"]
      }
    },
    "links": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "to_node_id": {
            "type": "string",
            "description": "ID des verlinkten Knotens"
          },
          "relation": {
            "type": "string",
            "enum": ["supports", "contradicts", "informs", "inspired_by", "analogous_to"],
            "description": "Art der Beziehung"
          },
          "notes": {
            "type": ["string", "null"],
            "description": "Zusätzliche Anmerkungen"
          }
        },
        "required": ["to_node_id", "relation"]
      }
    },
    "creative_room": {
      "type": "object",
      "properties": {
        "prompt": {
          "type": ["string", "null"],
          "description": "Prompt für kreative Auseinandersetzung"
        },
        "myth_seed": {
          "type": ["string", "null"],
          "description": "Mythologischer Kern"
        },
        "self_reflection_questions": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Fragen zur Selbstreflexion"
        }
      }
    }
  },
  "required": ["node_id", "title", "node_type", "epistemic_layer_id"]
}
